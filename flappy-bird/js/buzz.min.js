 // ----------------------------------------------------------------------------
 // buzz, a javascript html5 audio library
 // v1.1.0 - released 2013-08-15 13:18
 // licensed under the mit license.
 // http://buzz.jaysalvat.com/
 // ----------------------------------------------------------------------------
 // copyright (c) 2010-2013 jay salvat
 // http://jaysalvat.com/
 // ----------------------------------------------------------------------------

 (function(t,n,e){"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof n.define&&n.define.amd?define(t,[],e):n[t]=e()})("buzz",this,function(){var t={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,document:document},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createelement("audio"),sound:function(n,e){function i(t){for(var n=[],e=t.length-1,i=0;e>=i;i++)n.push({start:t.start(i),end:t.end(i)});return n}function u(t){return t.split(".").pop()}function s(n,e){var i=r.createelement("source");i.src=e,t.types[u(e)]&&(i.type=t.types[u(e)]),n.appendchild(i)}e=e||{};var r=e.document||t.defaults.document,o=0,a=[],h={},l=t.issupported();if(this.load=function(){return l?(this.sound.load(),this):this},this.play=function(){return l?(this.sound.play(),this):this},this.toggleplay=function(){return l?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return l?(this.sound.pause(),this):this},this.ispaused=function(){return l?this.sound.paused:null},this.stop=function(){return l?(this.settime(0),this.sound.pause(),this):this},this.isended=function(){return l?this.sound.ended:null},this.loop=function(){return l?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currenttime=0,this.play()}),this):this},this.unloop=function(){return l?(this.sound.removeattribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return l?(this.sound.muted=!0,this):this},this.unmute=function(){return l?(this.sound.muted=!1,this):this},this.togglemute=function(){return l?(this.sound.muted=!this.sound.muted,this):this},this.ismuted=function(){return l?this.sound.muted:null},this.setvolume=function(t){return l?(0>t&&(t=0),t>100&&(t=100),this.volume=t,this.sound.volume=t/100,this):this},this.getvolume=function(){return l?this.volume:this},this.increasevolume=function(t){return this.setvolume(this.volume+(t||1))},this.decreasevolume=function(t){return this.setvolume(this.volume-(t||1))},this.settime=function(t){if(!l)return this;var n=!0;return this.whenready(function(){n===!0&&(n=!1,this.sound.currenttime=t)}),this},this.gettime=function(){if(!l)return null;var n=math.round(100*this.sound.currenttime)/100;return isnan(n)?t.defaults.placeholder:n},this.setpercent=function(n){return l?this.settime(t.frompercent(n,this.sound.duration)):this},this.getpercent=function(){if(!l)return null;var n=math.round(t.topercent(this.sound.currenttime,this.sound.duration));return isnan(n)?t.defaults.placeholder:n},this.setspeed=function(t){return l?(this.sound.playbackrate=t,this):this},this.getspeed=function(){return l?this.sound.playbackrate:null},this.getduration=function(){if(!l)return null;var n=math.round(100*this.sound.duration)/100;return isnan(n)?t.defaults.placeholder:n},this.getplayed=function(){return l?i(this.sound.played):null},this.getbuffered=function(){return l?i(this.sound.buffered):null},this.getseekable=function(){return l?i(this.sound.seekable):null},this.geterrorcode=function(){return l&&this.sound.error?this.sound.error.code:0},this.geterrormessage=function(){if(!l)return null;switch(this.geterrorcode()){case 1:return"media_err_aborted";case 2:return"media_err_network";case 3:return"media_err_decode";case 4:return"media_err_src_not_supported";default:return null}},this.getstatecode=function(){return l?this.sound.readystate:null},this.getstatemessage=function(){if(!l)return null;switch(this.getstatecode()){case 0:return"have_nothing";case 1:return"have_metadata";case 2:return"have_current_data";case 3:return"have_future_data";case 4:return"have_enough_data";default:return null}},this.getnetworkstatecode=function(){return l?this.sound.networkstate:null},this.getnetworkstatemessage=function(){if(!l)return null;switch(this.getnetworkstatecode()){case 0:return"network_empty";case 1:return"network_idle";case 2:return"network_loading";case 3:return"network_no_source";default:return null}},this.set=function(t,n){return l?(this.sound[t]=n,this):this},this.get=function(t){return l?t?this.sound[t]:this.sound:null},this.bind=function(t,n){if(!l)return this;t=t.split(" ");for(var e=this,i=function(t){n.call(e,t)},u=0;t.length>u;u++){var s=t[u],r=s;s=r.split(".")[0],a.push({idx:r,func:i}),this.sound.addeventlistener(s,i,!0)}return this},this.unbind=function(t){if(!l)return this;t=t.split(" ");for(var n=0;t.length>n;n++)for(var e=t[n],i=e.split(".")[0],u=0;a.length>u;u++){var s=a[u].idx.split(".");(a[u].idx==e||s[1]&&s[1]==e.replace(".",""))&&(this.sound.removeeventlistener(i,a[u].func,!0),a.splice(u,1))}return this},this.bindonce=function(t,n){if(!l)return this;var e=this;return h[o++]=!1,this.bind(t+"."+o,function(){h[o]||(h[o]=!0,n.call(e)),e.unbind(t+"."+o)}),this},this.trigger=function(t){if(!l)return this;t=t.split(" ");for(var n=0;t.length>n;n++)for(var e=t[n],i=0;a.length>i;i++){var u=a[i].idx.split(".");if(a[i].idx==e||u[0]&&u[0]==e.replace(".","")){var s=r.createevent("htmlevents");s.initevent(u[0],!1,!0),this.sound.dispatchevent(s)}}return this},this.fadeto=function(n,e,i){function u(){settimeout(function(){n>s&&n>o.volume?(o.setvolume(o.volume+=1),u()):s>n&&o.volume>n?(o.setvolume(o.volume-=1),u()):i instanceof function&&i.apply(o)},r)}if(!l)return this;e instanceof function?(i=e,e=t.defaults.duration):e=e||t.defaults.duration;var s=this.volume,r=e/math.abs(s-n),o=this;return this.play(),this.whenready(function(){u()}),this},this.fadein=function(t,n){return l?this.setvolume(0).fadeto(100,t,n):this},this.fadeout=function(t,n){return l?this.fadeto(0,t,n):this},this.fadewith=function(t,n){return l?(this.fadeout(n,function(){this.stop()}),t.play().fadein(n),this):this},this.whenready=function(t){if(!l)return null;var n=this;0===this.sound.readystate?this.bind("canplay.buzzwhenready",function(){t.call(n)}):t.call(n)},l&&n){for(var d in t.defaults)t.defaults.hasownproperty(d)&&(e[d]=e[d]||t.defaults[d]);if(this.sound=r.createelement("audio"),n instanceof array)for(var c in n)n.hasownproperty(c)&&s(this.sound,n[c]);else if(e.formats.length)for(var f in e.formats)e.formats.hasownproperty(f)&&s(this.sound,n+"."+e.formats[f]);else s(this.sound,n);e.loop&&this.loop(),e.autoplay&&(this.sound.autoplay="autoplay"),this.sound.preload=e.preload===!0?"auto":e.preload===!1?"none":e.preload,this.setvolume(e.volume),t.sounds.push(this)}},group:function(t){function n(){for(var n=e(null,arguments),i=n.shift(),u=0;t.length>u;u++)t[u][i].apply(t[u],n)}function e(t,n){return t instanceof array?t:array.prototype.slice.call(n)}t=e(t,arguments),this.getsounds=function(){return t},this.add=function(n){n=e(n,arguments);for(var i=0;n.length>i;i++)t.push(n[i])},this.remove=function(n){n=e(n,arguments);for(var i=0;n.length>i;i++)for(var u=0;t.length>u;u++)if(t[u]==n[i]){t.splice(u,1);break}},this.load=function(){return n("load"),this},this.play=function(){return n("play"),this},this.toggleplay=function(){return n("toggleplay"),this},this.pause=function(t){return n("pause",t),this},this.stop=function(){return n("stop"),this},this.mute=function(){return n("mute"),this},this.unmute=function(){return n("unmute"),this},this.togglemute=function(){return n("togglemute"),this},this.setvolume=function(t){return n("setvolume",t),this},this.increasevolume=function(t){return n("increasevolume",t),this},this.decreasevolume=function(t){return n("decreasevolume",t),this},this.loop=function(){return n("loop"),this},this.unloop=function(){return n("unloop"),this},this.settime=function(t){return n("settime",t),this},this.set=function(t,e){return n("set",t,e),this},this.bind=function(t,e){return n("bind",t,e),this},this.unbind=function(t){return n("unbind",t),this},this.bindonce=function(t,e){return n("bindonce",t,e),this},this.trigger=function(t){return n("trigger",t),this},this.fade=function(t,e,i,u){return n("fade",t,e,i,u),this},this.fadein=function(t,e){return n("fadein",t,e),this},this.fadeout=function(t,e){return n("fadeout",t,e),this}},all:function(){return new t.group(t.sounds)},issupported:function(){return!!t.el.canplaytype},isoggsupported:function(){return!!t.el.canplaytype&&t.el.canplaytype('audio/ogg; codecs="vorbis"')},iswavsupported:function(){return!!t.el.canplaytype&&t.el.canplaytype('audio/wav; codecs="1"')},ismp3supported:function(){return!!t.el.canplaytype&&t.el.canplaytype("audio/mpeg;")},isaacsupported:function(){return!!t.el.canplaytype&&(t.el.canplaytype("audio/x-m4a;")||t.el.canplaytype("audio/aac;"))},totimer:function(t,n){var e,i,u;return e=math.floor(t/3600),e=isnan(e)?"--":e>=10?e:"0"+e,i=n?math.floor(t/60%60):math.floor(t/60),i=isnan(i)?"--":i>=10?i:"0"+i,u=math.floor(t%60),u=isnan(u)?"--":u>=10?u:"0"+u,n?e+":"+i+":"+u:i+":"+u},fromtimer:function(t){var n=(""+t).split(":");return n&&3==n.length&&(t=3600*parseint(n[0],10)+60*parseint(n[1],10)+parseint(n[2],10)),n&&2==n.length&&(t=60*parseint(n[0],10)+parseint(n[1],10)),t},topercent:function(t,n,e){var i=math.pow(10,e||0);return math.round(100*t/n*i)/i},frompercent:function(t,n,e){var i=math.pow(10,e||0);return math.round(n/100*t*i)/i}};return t});